* Neural Network Current Table
* This uses B-source lookup tables to implement the neural network model

* B-source for the neural network current
* Uses table_model() from our CSV data as a lookup table
Bnn d_nn s_nn i='table_model(v(g_nn),v(d_nn))'

* Make sure we have dummy source for 0 Vd to avoid divide by zero
.func dummy_zero(vd) = (vd < 0.001) ? 0 : vd

* Table model function - we implement as a set of 1D tables, one for each Vg value
* This is more compatible with older HSPICE versions than PWL2D
.func table_model(vg,vd) = \
+ (vg < 0.05) ? vg_0(dummy_zero(vd)) : \
+ (vg < 0.15) ? vg_10(dummy_zero(vd)) : \
+ (vg < 0.25) ? vg_20(dummy_zero(vd)) : \
+ (vg < 0.35) ? vg_30(dummy_zero(vd)) : \
+ (vg < 0.45) ? vg_40(dummy_zero(vd)) : \
+ (vg < 0.55) ? vg_50(dummy_zero(vd)) : \
+ (vg < 0.65) ? vg_60(dummy_zero(vd)) : \
+ (vg < 0.75) ? vg_70(dummy_zero(vd)) : \
+ vg_80(dummy_zero(vd))

* Table for Vg=0.0
.func vg_0(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 8.69166250e-11 : \
+ (vd < 0.03) ? 3.14410116e-10 : \
+ (vd < 0.04) ? 5.88536526e-10 : \
+ (vd < 0.05) ? 4.60490135e-10 : \
+ (vd < 0.06) ? 3.43561313e-10 : \
+ (vd < 0.07) ? 3.65579647e-10 : \
+ (vd < 0.08) ? 3.82573844e-10 : \
+ (vd < 0.09) ? 1.23369190e-09 : \
+ (vd < 0.10) ? 4.07636405e-10 : \
+ (vd < 0.11) ? 6.07199535e-10 : \
+ (vd < 0.12) ? 6.19406983e-10 : \
+ (vd < 0.13) ? 3.01165759e-10 : \
+ (vd < 0.14) ? 6.41017999e-10 : \
+ (vd < 0.15) ? 1.37802127e-09 : \
+ (vd < 0.16) ? 1.39703915e-09 : \
+ (vd < 0.17) ? 3.21028786e-10 : \
+ (vd < 0.18) ? 3.25356608e-10 : \
+ (vd < 0.19) ? 3.29498029e-10 : \
+ (vd < 0.20) ? 1.00956151e-09 : \
+ (vd < 0.21) ? 3.37313932e-10 : \
+ (vd < 0.22) ? 1.03246530e-09 : \
+ (vd < 0.23) ? 1.51784390e-09 : \
+ (vd < 0.24) ? 3.48201700e-10 : \
+ (vd < 0.25) ? 5.05217255e-10 : \
+ (vd < 0.26) ? 3.55130314e-10 : \
+ (vd < 0.27) ? 5.14931728e-10 : \
+ (vd < 0.28) ? 1.59581416e-09 : \
+ (vd < 0.29) ? 1.61110929e-09 : \
+ (vd < 0.30) ? 7.67840229e-10 : \
+ (vd < 0.31) ? 1.12816916e-09 : \
+ (vd < 0.32) ? 1.65722878e-09 : \
+ (vd < 0.33) ? 7.89316630e-10 : \
+ (vd < 0.34) ? 1.68855729e-09 : \
+ (vd < 0.35) ? 1.70449558e-09 : \
+ (vd < 0.36) ? 8.11529344e-10 : \
+ (vd < 0.37) ? 1.73703148e-09 : \
+ (vd < 0.38) ? 8.26876785e-10 : \
+ (vd < 0.39) ? 8.34726737e-10 : \
+ (vd < 0.40) ? 8.42694241e-10 : \
+ (vd < 0.41) ? 1.24003563e-09 : \
+ (vd < 0.42) ? 5.91775000e-10 : \
+ (vd < 0.43) ? 5.97463898e-10 : \
+ (vd < 0.44) ? 4.21165061e-10 : \
+ (vd < 0.45) ? 4.25282858e-10 : \
+ (vd < 0.46) ? 4.29445079e-10 : \
+ (vd < 0.47) ? 9.01570556e-10 : \
+ (vd < 0.48) ? 1.32806945e-09 : \
+ (vd < 0.49) ? 4.42191324e-10 : \
+ (vd < 0.50) ? 1.97300808e-09 : \
+ (vd < 0.51) ? 6.45314691e-10 : \
+ (vd < 0.52) ? 4.55293291e-10 : \
+ (vd < 0.53) ? 6.57805135e-10 : \
+ (vd < 0.54) ? 9.64608847e-10 : \
+ (vd < 0.55) ? 9.73829877e-10 : \
+ (vd < 0.56) ? 4.73274545e-10 : \
+ (vd < 0.57) ? 4.77860582e-10 : \
+ (vd < 0.58) ? 1.00168256e-09 : \
+ (vd < 0.59) ? 1.01101545e-09 : \
+ (vd < 0.60) ? 4.91837933e-10 : \
+ (vd < 0.61) ? 2.19339307e-09 : \
+ (vd < 0.62) ? 7.15838229e-10 : \
+ (vd < 0.63) ? 2.23353036e-09 : \
+ (vd < 0.64) ? 1.05789187e-09 : \
+ (vd < 0.65) ? 5.15936023e-10 : \
+ (vd < 0.66) ? 2.29313614e-09 : \
+ (vd < 0.67) ? 2.31279064e-09 : \
+ (vd < 0.68) ? 1.09552351e-09 : \
+ (vd < 0.69) ? 1.61230949e-09 : \
+ (vd < 0.70) ? 7.69685442e-10 : \
+ (vd < 0.71) ? 1.63890521e-09 : \
+ (vd < 0.72) ? 5.51719753e-10 : \
+ (vd < 0.73) ? 7.90532440e-10 : \
+ (vd < 0.74) ? 1.67837041e-09 : \
+ (vd < 0.75) ? 5.67946761e-10 : \
+ (vd < 0.76) ? 5.73493503e-10 : \
+ (vd < 0.77) ? 2.50125646e-09 : \
+ (vd < 0.78) ? 8.26295248e-10 : \
+ (vd < 0.79) ? 8.33624723e-10 : \
+ (vd < 0.80) ? 8.41014149e-10 : \
+ 1.76841528e-09

* Table for Vg=0.1
.func vg_10(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 5.92735994e-10 : \
+ (vd < 0.03) ? 1.34975642e-08 : \
+ (vd < 0.04) ? 8.25911457e-09 : \
+ (vd < 0.05) ? 4.50292703e-09 : \
+ (vd < 0.06) ? 2.31188775e-09 : \
+ (vd < 0.07) ? 1.67693230e-09 : \
+ (vd < 0.08) ? 3.52149596e-08 : \
+ (vd < 0.09) ? 5.58956913e-09 : \
+ (vd < 0.10) ? 2.55751516e-08 : \
+ (vd < 0.11) ? 2.60482949e-08 : \
+ (vd < 0.12) ? 1.91810980e-09 : \
+ (vd < 0.13) ? 2.68331814e-08 : \
+ (vd < 0.14) ? 2.71887336e-08 : \
+ (vd < 0.15) ? 6.19027404e-09 : \
+ (vd < 0.16) ? 6.27122994e-09 : \
+ (vd < 0.17) ? 2.82297424e-08 : \
+ (vd < 0.18) ? 1.36045043e-08 : \
+ (vd < 0.19) ? 1.99863435e-08 : \
+ (vd < 0.20) ? 9.58696980e-09 : \
+ (vd < 0.21) ? 2.04780406e-08 : \
+ (vd < 0.22) ? 6.73449744e-09 : \
+ (vd < 0.23) ? 2.20706875e-09 : \
+ (vd < 0.24) ? 1.45941723e-08 : \
+ (vd < 0.25) ? 4.76889184e-09 : \
+ (vd < 0.26) ? 2.27545915e-09 : \
+ (vd < 0.27) ? 2.18805913e-08 : \
+ (vd < 0.28) ? 4.62845007e-08 : \
+ (vd < 0.29) ? 1.05235205e-08 : \
+ (vd < 0.30) ? 2.25146488e-08 : \
+ (vd < 0.31) ? 1.56121430e-08 : \
+ (vd < 0.32) ? 3.49796991e-09 : \
+ (vd < 0.33) ? 2.43059390e-09 : \
+ (vd < 0.34) ? 2.32950580e-08 : \
+ (vd < 0.35) ? 2.34818617e-08 : \
+ (vd < 0.36) ? 2.49910481e-09 : \
+ (vd < 0.37) ? 2.38498041e-08 : \
+ (vd < 0.38) ? 3.69241332e-09 : \
+ (vd < 0.39) ? 5.40440135e-09 : \
+ (vd < 0.40) ? 5.45228358e-09 : \
+ (vd < 0.41) ? 1.69033129e-08 : \
+ (vd < 0.42) ? 2.47652373e-08 : \
+ (vd < 0.43) ? 2.67132183e-09 : \
+ (vd < 0.44) ? 5.27022526e-08 : \
+ (vd < 0.45) ? 1.74391488e-08 : \
+ (vd < 0.46) ? 1.21001825e-08 : \
+ (vd < 0.47) ? 5.81107397e-09 : \
+ (vd < 0.48) ? 1.23063251e-08 : \
+ (vd < 0.49) ? 2.61231497e-08 : \
+ (vd < 0.50) ? 5.97746127e-09 : \
+ (vd < 0.51) ? 1.26282460e-08 : \
+ (vd < 0.52) ? 1.84599921e-08 : \
+ (vd < 0.53) ? 3.90067999e-08 : \
+ (vd < 0.54) ? 3.93114387e-08 : \
+ (vd < 0.55) ? 5.71540805e-08 : \
+ (vd < 0.56) ? 5.75935818e-08 : \
+ (vd < 0.57) ? 1.92539724e-08 : \
+ (vd < 0.58) ? 4.47230775e-09 : \
+ (vd < 0.59) ? 5.89453013e-08 : \
+ (vd < 0.60) ? 5.94058520e-08 : \
+ (vd < 0.61) ? 1.99176718e-08 : \
+ (vd < 0.62) ? 9.64240337e-09 : \
+ (vd < 0.63) ? 3.24257301e-09 : \
+ (vd < 0.64) ? 2.04252765e-08 : \
+ (vd < 0.65) ? 2.97314523e-08 : \
+ (vd < 0.66) ? 3.32985606e-09 : \
+ (vd < 0.67) ? 1.45139399e-08 : \
+ (vd < 0.68) ? 6.32129527e-08 : \
+ (vd < 0.69) ? 3.41546682e-09 : \
+ (vd < 0.70) ? 4.97773726e-09 : \
+ (vd < 0.71) ? 7.23152036e-09 : \
+ (vd < 0.72) ? 3.49886156e-09 : \
+ (vd < 0.73) ? 1.05750289e-08 : \
+ (vd < 0.74) ? 1.53429596e-08 : \
+ (vd < 0.75) ? 4.62663576e-08 : \
+ (vd < 0.76) ? 1.55707540e-08 : \
+ (vd < 0.77) ? 4.69223809e-08 : \
+ (vd < 0.78) ? 6.79901343e-08 : \
+ (vd < 0.79) ? 1.59017094e-08 : \
+ (vd < 0.80) ? 1.11215478e-08 : \
+ 4.81932773e-08

* Table for Vg=0.2
.func vg_20(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 1.64874450e-08 : \
+ (vd < 0.03) ? 1.14844461e-07 : \
+ (vd < 0.04) ? 5.22444816e-08 : \
+ (vd < 0.05) ? 3.36966878e-07 : \
+ (vd < 0.06) ? 4.60813936e-08 : \
+ (vd < 0.07) ? 9.51003203e-07 : \
+ (vd < 0.08) ? 1.06598583e-07 : \
+ (vd < 0.09) ? 6.01084066e-07 : \
+ (vd < 0.10) ? 1.40617803e-06 : \
+ (vd < 0.11) ? 1.64164021e-07 : \
+ (vd < 0.12) ? 6.41661231e-07 : \
+ (vd < 0.13) ? 2.40085456e-07 : \
+ (vd < 0.14) ? 8.86220610e-07 : \
+ (vd < 0.15) ? 4.82110559e-07 : \
+ (vd < 0.16) ? 5.82230413e-08 : \
+ (vd < 0.17) ? 9.08751827e-07 : \
+ (vd < 0.18) ? 3.53991184e-07 : \
+ (vd < 0.19) ? 6.02565115e-08 : \
+ (vd < 0.20) ? 1.22940986e-06 : \
+ (vd < 0.21) ? 3.63011372e-07 : \
+ (vd < 0.22) ? 6.97873568e-07 : \
+ (vd < 0.23) ? 9.47467252e-07 : \
+ (vd < 0.24) ? 7.08776151e-07 : \
+ (vd < 0.25) ? 2.68073727e-07 : \
+ (vd < 0.26) ? 2.70708341e-07 : \
+ (vd < 0.27) ? 2.73348978e-07 : \
+ (vd < 0.28) ? 9.82952538e-07 : \
+ (vd < 0.29) ? 9.90290000e-07 : \
+ (vd < 0.30) ? 1.70090389e-06 : \
+ (vd < 0.31) ? 2.00698696e-07 : \
+ (vd < 0.32) ? 1.01225912e-06 : \
+ (vd < 0.33) ? 1.00335574e-07 : \
+ (vd < 0.34) ? 7.04616738e-08 : \
+ (vd < 0.35) ? 1.75418601e-06 : \
+ (vd < 0.36) ? 1.04063656e-06 : \
+ (vd < 0.37) ? 1.04748120e-06 : \
+ (vd < 0.38) ? 2.12571186e-07 : \
+ (vd < 0.39) ? 7.32660095e-08 : \
+ (vd < 0.40) ? 3.04496174e-07 : \
+ (vd < 0.41) ? 1.07382639e-06 : \
+ (vd < 0.42) ? 5.95029886e-07 : \
+ (vd < 0.43) ? 1.54831045e-07 : \
+ (vd < 0.44) ? 3.12781190e-07 : \
+ (vd < 0.45) ? 1.44065972e-06 : \
+ (vd < 0.46) ? 7.70204252e-08 : \
+ (vd < 0.47) ? 6.13536502e-07 : \
+ (vd < 0.48) ? 2.27633298e-07 : \
+ (vd < 0.49) ? 3.23049353e-07 : \
+ (vd < 0.50) ? 8.47206890e-07 : \
+ (vd < 0.51) ? 2.32236559e-07 : \
+ (vd < 0.52) ? 1.92044743e-06 : \
+ (vd < 0.53) ? 2.35402681e-07 : \
+ (vd < 0.54) ? 8.15995016e-08 : \
+ (vd < 0.55) ? 8.71963330e-07 : \
+ (vd < 0.56) ? 6.47744957e-07 : \
+ (vd < 0.57) ? 4.74190933e-07 : \
+ (vd < 0.58) ? 1.54258656e-06 : \
+ (vd < 0.59) ? 1.98872406e-06 : \
+ (vd < 0.60) ? 1.74396146e-07 : \
+ (vd < 0.61) ? 1.23219979e-07 : \
+ (vd < 0.62) ? 3.52436325e-07 : \
+ (vd < 0.63) ? 1.78306742e-07 : \
+ (vd < 0.64) ? 9.19590732e-07 : \
+ (vd < 0.65) ? 1.22774261e-06 : \
+ (vd < 0.66) ? 8.94046941e-08 : \
+ (vd < 0.67) ? 1.28938633e-07 : \
+ (vd < 0.68) ? 5.09972541e-07 : \
+ (vd < 0.69) ? 2.63772079e-07 : \
+ (vd < 0.70) ? 5.16720482e-07 : \
+ (vd < 0.71) ? 1.64994510e-06 : \
+ (vd < 0.72) ? 3.77681257e-07 : \
+ (vd < 0.73) ? 9.42227518e-08 : \
+ (vd < 0.74) ? 1.28828857e-06 : \
+ (vd < 0.75) ? 1.68123816e-06 : \
+ (vd < 0.76) ? 9.84690132e-07 : \
+ (vd < 0.77) ? 2.16142163e-06 : \
+ (vd < 0.78) ? 9.94855828e-07 : \
+ (vd < 0.79) ? 3.95178396e-07 : \
+ (vd < 0.80) ? 3.97580629e-07 : \
+ 5.52574238e-07

* Table for Vg=0.3
.func vg_30(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 4.07610605e-07 : \
+ (vd < 0.03) ? 1.83780750e-06 : \
+ (vd < 0.04) ? 2.12180719e-06 : \
+ (vd < 0.05) ? 2.03121526e-06 : \
+ (vd < 0.06) ? 1.67841645e-06 : \
+ (vd < 0.07) ? 1.51349122e-06 : \
+ (vd < 0.08) ? 5.22455426e-06 : \
+ (vd < 0.09) ? 3.00724379e-06 : \
+ (vd < 0.10) ? 5.42435355e-06 : \
+ (vd < 0.11) ? 5.69910480e-06 : \
+ (vd < 0.12) ? 1.87026615e-06 : \
+ (vd < 0.13) ? 6.13808341e-06 : \
+ (vd < 0.14) ? 6.31209430e-06 : \
+ (vd < 0.15) ? 3.59430735e-06 : \
+ (vd < 0.16) ? 3.64380048e-06 : \
+ (vd < 0.17) ? 6.69962028e-06 : \
+ (vd < 0.18) ? 5.16706466e-06 : \
+ (vd < 0.19) ? 6.02754772e-06 : \
+ (vd < 0.20) ? 4.49487206e-06 : \
+ (vd < 0.21) ? 6.13504308e-06 : \
+ (vd < 0.22) ? 3.83017996e-06 : \
+ (vd < 0.23) ? 2.07440058e-06 : \
+ (vd < 0.24) ? 5.40312378e-06 : \
+ (vd < 0.25) ? 3.22165739e-06 : \
+ (vd < 0.26) ? 2.11062138e-06 : \
+ (vd < 0.27) ? 6.34828866e-06 : \
+ (vd < 0.28) ? 8.26878153e-06 : \
+ (vd < 0.29) ? 4.71583822e-06 : \
+ (vd < 0.30) ? 6.42852963e-06 : \
+ (vd < 0.31) ? 5.57544499e-06 : \
+ (vd < 0.32) ? 2.72317642e-06 : \
+ (vd < 0.33) ? 2.19777270e-06 : \
+ (vd < 0.34) ? 6.52877041e-06 : \
+ (vd < 0.35) ? 6.55355485e-06 : \
+ (vd < 0.36) ? 2.23512459e-06 : \
+ (vd < 0.37) ? 6.60324760e-06 : \
+ (vd < 0.38) ? 2.80943262e-06 : \
+ (vd < 0.39) ? 3.45066108e-06 : \
+ (vd < 0.40) ? 3.46687109e-06 : \
+ (vd < 0.41) ? 5.80255983e-06 : \
+ (vd < 0.42) ? 6.72911061e-06 : \
+ (vd < 0.43) ? 2.31898991e-06 : \
+ (vd < 0.44) ? 8.75988926e-06 : \
+ (vd < 0.45) ? 5.89495441e-06 : \
+ (vd < 0.46) ? 5.06580741e-06 : \
+ (vd < 0.47) ? 3.57890272e-06 : \
+ (vd < 0.48) ? 5.10736268e-06 : \
+ (vd < 0.49) ? 6.90943853e-06 : \
+ (vd < 0.50) ? 3.62660139e-06 : \
+ (vd < 0.51) ? 5.16993805e-06 : \
+ (vd < 0.52) ? 6.05871273e-06 : \
+ (vd < 0.53) ? 8.00218804e-06 : \
+ (vd < 0.54) ? 8.03115185e-06 : \
+ (vd < 0.55) ? 9.10475064e-06 : \
+ (vd < 0.56) ? 9.13639833e-06 : \
+ (vd < 0.57) ? 6.17690886e-06 : \
+ (vd < 0.58) ? 3.08496290e-06 : \
+ (vd < 0.59) ? 9.23086060e-06 : \
+ (vd < 0.60) ? 9.26206601e-06 : \
+ (vd < 0.61) ? 6.27105401e-06 : \
+ (vd < 0.62) ? 4.57445841e-06 : \
+ (vd < 0.63) ? 2.55198746e-06 : \
+ (vd < 0.64) ? 6.34027071e-06 : \
+ (vd < 0.65) ? 7.32526998e-06 : \
+ (vd < 0.66) ? 2.58746834e-06 : \
+ (vd < 0.67) ? 5.50214241e-06 : \
+ (vd < 0.68) ? 9.49979267e-06 : \
+ (vd < 0.69) ? 2.62220194e-06 : \
+ (vd < 0.70) ? 3.24924687e-06 : \
+ (vd < 0.71) ? 3.95866919e-06 : \
+ (vd < 0.72) ? 2.65559066e-06 : \
+ (vd < 0.73) ? 4.76303809e-06 : \
+ (vd < 0.74) ? 5.62840845e-06 : \
+ (vd < 0.75) ? 8.58378471e-06 : \
+ (vd < 0.76) ? 5.65922051e-06 : \
+ (vd < 0.77) ? 8.62102741e-06 : \
+ (vd < 0.78) ? 9.73094910e-06 : \
+ (vd < 0.79) ? 5.69962000e-06 : \
+ (vd < 0.80) ? 4.85410816e-06 : \
+ 8.68060015e-06

* Table for Vg=0.4
.func vg_40(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 1.12815374e-06 : \
+ (vd < 0.03) ? 2.65435432e-06 : \
+ (vd < 0.04) ? 3.24250803e-06 : \
+ (vd < 0.05) ? 5.35196799e-06 : \
+ (vd < 0.06) ? 4.53514003e-06 : \
+ (vd < 0.07) ? 8.43121321e-06 : \
+ (vd < 0.08) ? 6.65278312e-06 : \
+ (vd < 0.09) ? 9.69177694e-06 : \
+ (vd < 0.10) ? 1.19713484e-05 : \
+ (vd < 0.11) ? 8.90241427e-06 : \
+ (vd < 0.12) ? 1.19792793e-05 : \
+ (vd < 0.13) ? 1.05229128e-05 : \
+ (vd < 0.14) ? 1.38967492e-05 : \
+ (vd < 0.15) ? 1.29185760e-05 : \
+ (vd < 0.16) ? 8.24406507e-06 : \
+ (vd < 0.17) ? 1.54350337e-05 : \
+ (vd < 0.18) ? 1.31349019e-05 : \
+ (vd < 0.19) ? 8.66760034e-06 : \
+ (vd < 0.20) ? 1.75139377e-05 : \
+ (vd < 0.21) ? 1.38394375e-05 : \
+ (vd < 0.22) ? 1.60939945e-05 : \
+ (vd < 0.23) ? 1.73612584e-05 : \
+ (vd < 0.24) ? 1.64921564e-05 : \
+ (vd < 0.25) ? 1.33595898e-05 : \
+ (vd < 0.26) ? 1.34570655e-05 : \
+ (vd < 0.27) ? 1.35443069e-05 : \
+ (vd < 0.28) ? 1.82172473e-05 : \
+ (vd < 0.29) ? 1.83391149e-05 : \
+ (vd < 0.30) ? 2.08267289e-05 : \
+ (vd < 0.31) ? 1.26741437e-05 : \
+ (vd < 0.32) ? 1.86423610e-05 : \
+ (vd < 0.33) ? 1.05329230e-05 : \
+ (vd < 0.34) ? 9.49519263e-06 : \
+ (vd < 0.35) ? 2.13698702e-05 : \
+ (vd < 0.36) ? 1.89540398e-05 : \
+ (vd < 0.37) ? 1.90224961e-05 : \
+ (vd < 0.38) ? 1.29871675e-05 : \
+ (vd < 0.39) ? 9.65710486e-06 : \
+ (vd < 0.40) ? 1.42580094e-05 : \
+ (vd < 0.41) ? 1.92781314e-05 : \
+ (vd < 0.42) ? 1.68076475e-05 : \
+ (vd < 0.43) ? 1.20248483e-05 : \
+ (vd < 0.44) ? 1.44371613e-05 : \
+ (vd < 0.45) ? 2.08199940e-05 : \
+ (vd < 0.46) ? 9.88823267e-06 : \
+ (vd < 0.47) ? 1.70677382e-05 : \
+ (vd < 0.48) ? 1.34044275e-05 : \
+ (vd < 0.49) ? 1.46634271e-05 : \
+ (vd < 0.50) ? 1.85119980e-05 : \
+ (vd < 0.51) ? 1.35319715e-05 : \
+ (vd < 0.52) ? 2.26012800e-05 : \
+ (vd < 0.53) ? 1.36170362e-05 : \
+ (vd < 0.54) ? 1.01613061e-05 : \
+ (vd < 0.55) ? 1.87833146e-05 : \
+ (vd < 0.56) ? 1.75291485e-05 : \
+ (vd < 0.57) ? 1.62898727e-05 : \
+ (vd < 0.58) ? 2.16170621e-05 : \
+ (vd < 0.59) ? 2.30355164e-05 : \
+ (vd < 0.60) ? 1.26939806e-05 : \
+ (vd < 0.61) ? 1.15472536e-05 : \
+ (vd < 0.62) ? 1.52409987e-05 : \
+ (vd < 0.63) ? 1.28075939e-05 : \
+ (vd < 0.64) ? 1.92334542e-05 : \
+ (vd < 0.65) ? 2.06239265e-05 : \
+ (vd < 0.66) ? 1.05612255e-05 : \
+ (vd < 0.67) ? 1.17533046e-05 : \
+ (vd < 0.68) ? 1.67671153e-05 : \
+ (vd < 0.69) ? 1.42529202e-05 : \
+ (vd < 0.70) ? 1.68420322e-05 : \
+ (vd < 0.71) ? 2.22461098e-05 : \
+ (vd < 0.72) ? 1.56188365e-05 : \
+ (vd < 0.73) ? 1.07600017e-05 : \
+ (vd < 0.74) ? 2.09843946e-05 : \
+ (vd < 0.75) ? 2.23858946e-05 : \
+ (vd < 0.76) ? 1.96905926e-05 : \
+ (vd < 0.77) ? 2.38269722e-05 : \
+ (vd < 0.78) ? 1.97432173e-05 : \
+ (vd < 0.79) ? 1.58059685e-05 : \
+ (vd < 0.80) ? 1.58254230e-05 : \
+ 1.71435531e-05

* Table for Vg=0.5
.func vg_50(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 1.71499065e-06 : \
+ (vd < 0.03) ? 3.84246669e-06 : \
+ (vd < 0.04) ? 5.46559677e-06 : \
+ (vd < 0.05) ? 6.84524537e-06 : \
+ (vd < 0.06) ? 7.94513035e-06 : \
+ (vd < 0.07) ? 9.01540130e-06 : \
+ (vd < 0.08) ? 1.24983201e-05 : \
+ (vd < 0.09) ? 1.24579773e-05 : \
+ (vd < 0.10) ? 1.51241987e-05 : \
+ (vd < 0.11) ? 1.64515412e-05 : \
+ (vd < 0.12) ? 1.43159511e-05 : \
+ (vd < 0.13) ? 1.88934524e-05 : \
+ (vd < 0.14) ? 2.00096381e-05 : \
+ (vd < 0.15) ? 1.86615105e-05 : \
+ (vd < 0.16) ? 1.94581276e-05 : \
+ (vd < 0.17) ? 2.29537836e-05 : \
+ (vd < 0.18) ? 2.23822265e-05 : \
+ (vd < 0.19) ? 2.38541525e-05 : \
+ (vd < 0.20) ? 2.29086696e-05 : \
+ (vd < 0.21) ? 2.51817575e-05 : \
+ (vd < 0.22) ? 2.30470108e-05 : \
+ (vd < 0.23) ? 2.04800238e-05 : \
+ (vd < 0.24) ? 2.58356312e-05 : \
+ (vd < 0.25) ? 2.31713924e-05 : \
+ (vd < 0.26) ? 2.12771392e-05 : \
+ (vd < 0.27) ? 2.80151717e-05 : \
+ (vd < 0.28) ? 3.04406651e-05 : \
+ (vd < 0.29) ? 2.64454476e-05 : \
+ (vd < 0.30) ? 2.89375045e-05 : \
+ (vd < 0.31) ? 2.80496875e-05 : \
+ (vd < 0.32) ? 2.34962707e-05 : \
+ (vd < 0.33) ? 2.24044151e-05 : \
+ (vd < 0.34) ? 2.98328923e-05 : \
+ (vd < 0.35) ? 3.00139908e-05 : \
+ (vd < 0.36) ? 2.27149336e-05 : \
+ (vd < 0.37) ? 3.03397051e-05 : \
+ (vd < 0.38) ? 2.41698741e-05 : \
+ (vd < 0.39) ? 2.55449784e-05 : \
+ (vd < 0.40) ? 2.56419830e-05 : \
+ (vd < 0.41) ? 2.96117301e-05 : \
+ (vd < 0.42) ? 3.10144272e-05 : \
+ (vd < 0.43) ? 2.32954435e-05 : \
+ (vd < 0.44) ? 3.38315494e-05 : \
+ (vd < 0.45) ? 3.00552222e-05 : \
+ (vd < 0.46) ? 2.88358588e-05 : \
+ (vd < 0.47) ? 2.62614992e-05 : \
+ (vd < 0.48) ? 2.90278540e-05 : \
+ (vd < 0.49) ? 3.18046112e-05 : \
+ (vd < 0.50) ? 2.65085922e-05 : \
+ (vd < 0.51) ? 2.93056473e-05 : \
+ (vd < 0.52) ? 3.07570340e-05 : \
+ (vd < 0.53) ? 3.35717984e-05 : \
+ (vd < 0.54) ? 3.36753204e-05 : \
+ (vd < 0.55) ? 3.51387677e-05 : \
+ (vd < 0.56) ? 3.52433231e-05 : \
+ (vd < 0.57) ? 3.12047973e-05 : \
+ (vd < 0.58) ? 2.57268228e-05 : \
+ (vd < 0.59) ? 3.55385341e-05 : \
+ (vd < 0.60) ? 3.56302249e-05 : \
+ (vd < 0.61) ? 3.15198675e-05 : \
+ (vd < 0.62) ? 2.87771733e-05 : \
+ (vd < 0.63) ? 2.46407352e-05 : \
+ (vd < 0.64) ? 3.17264874e-05 : \
+ (vd < 0.65) ? 3.32060526e-05 : \
+ (vd < 0.66) ? 2.47970102e-05 : \
+ (vd < 0.67) ? 3.04850554e-05 : \
+ (vd < 0.68) ? 3.62258119e-05 : \
+ (vd < 0.69) ? 2.49368843e-05 : \
+ (vd < 0.70) ? 2.63822158e-05 : \
+ (vd < 0.71) ? 2.78350188e-05 : \
+ (vd < 0.72) ? 2.50593112e-05 : \
+ (vd < 0.73) ? 2.93305606e-05 : \
+ (vd < 0.74) ? 3.07892220e-05 : \
+ (vd < 0.75) ? 3.51077970e-05 : \
+ (vd < 0.76) ? 3.08507297e-05 : \
+ (vd < 0.77) ? 3.51620017e-05 : \
+ (vd < 0.78) ? 3.66124202e-05 : \
+ (vd < 0.79) ? 3.09216851e-05 : \
+ (vd < 0.80) ? 2.95188156e-05 : \
+ 3.52297327e-05

* Table for Vg=0.6
.func vg_60(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 2.01019473e-06 : \
+ (vd < 0.03) ? 4.16326016e-06 : \
+ (vd < 0.04) ? 5.93003759e-06 : \
+ (vd < 0.05) ? 8.29133030e-06 : \
+ (vd < 0.06) ? 9.42237020e-06 : \
+ (vd < 0.07) ? 1.24992538e-05 : \
+ (vd < 0.08) ? 1.31663821e-05 : \
+ (vd < 0.09) ? 1.58732978e-05 : \
+ (vd < 0.10) ? 1.82058460e-05 : \
+ (vd < 0.11) ? 1.81526470e-05 : \
+ (vd < 0.12) ? 2.08558035e-05 : \
+ (vd < 0.13) ? 2.13767082e-05 : \
+ (vd < 0.14) ? 2.41965232e-05 : \
+ (vd < 0.15) ? 2.48721571e-05 : \
+ (vd < 0.16) ? 2.31992417e-05 : \
+ (vd < 0.17) ? 2.83139618e-05 : \
+ (vd < 0.18) ? 2.80688365e-05 : \
+ (vd < 0.19) ? 2.60134303e-05 : \
+ (vd < 0.20) ? 3.23753977e-05 : \
+ (vd < 0.21) ? 3.10969510e-05 : \
+ (vd < 0.22) ? 3.32877960e-05 : \
+ (vd < 0.23) ? 3.48358342e-05 : \
+ (vd < 0.24) ? 3.50287245e-05 : \
+ (vd < 0.25) ? 3.35078139e-05 : \
+ (vd < 0.26) ? 3.41413033e-05 : \
+ (vd < 0.27) ? 3.47268663e-05 : \
+ (vd < 0.28) ? 3.86719835e-05 : \
+ (vd < 0.29) ? 3.92877706e-05 : \
+ (vd < 0.30) ? 4.15167364e-05 : \
+ (vd < 0.31) ? 3.56479330e-05 : \
+ (vd < 0.32) ? 4.08781058e-05 : \
+ (vd < 0.33) ? 3.41898366e-05 : \
+ (vd < 0.34) ? 3.33287675e-05 : \
+ (vd < 0.35) ? 4.40471226e-05 : \
+ (vd < 0.36) ? 4.25022110e-05 : \
+ (vd < 0.37) ? 4.28382281e-05 : \
+ (vd < 0.38) ? 3.76849108e-05 : \
+ (vd < 0.39) ? 3.43347517e-05 : \
+ (vd < 0.40) ? 3.92703564e-05 : \
+ (vd < 0.41) ? 4.39806143e-05 : \
+ (vd < 0.42) ? 4.19924607e-05 : \
+ (vd < 0.43) ? 3.74450239e-05 : \
+ (vd < 0.44) ? 4.00439141e-05 : \
+ (vd < 0.45) ? 4.60224136e-05 : \
+ (vd < 0.46) ? 3.53791555e-05 : \
+ (vd < 0.47) ? 4.29770890e-05 : \
+ (vd < 0.48) ? 3.94753557e-05 : \
+ (vd < 0.49) ? 4.08809481e-05 : \
+ (vd < 0.50) ? 4.47135678e-05 : \
+ (vd < 0.51) ? 3.99224409e-05 : \
+ (vd < 0.52) ? 4.86082720e-05 : \
+ (vd < 0.53) ? 4.02068582e-05 : \
+ (vd < 0.54) ? 3.63782445e-05 : \
+ (vd < 0.55) ? 4.55728384e-05 : \
+ (vd < 0.56) ? 4.44813886e-05 : \
+ (vd < 0.57) ? 4.33515094e-05 : \
+ (vd < 0.58) ? 4.85233074e-05 : \
+ (vd < 0.59) ? 4.99027039e-05 : \
+ (vd < 0.60) ? 3.97490714e-05 : \
+ (vd < 0.61) ? 3.84853774e-05 : \
+ (vd < 0.62) ? 4.26645300e-05 : \
+ (vd < 0.63) ? 4.00495261e-05 : \
+ (vd < 0.64) ? 4.68627812e-05 : \
+ (vd < 0.65) ? 4.82794689e-05 : \
+ (vd < 0.66) ? 3.75102751e-05 : \
+ (vd < 0.67) ? 3.89841760e-05 : \
+ (vd < 0.68) ? 4.45929442e-05 : \
+ (vd < 0.69) ? 4.19132799e-05 : \
+ (vd < 0.70) ? 4.47421517e-05 : \
+ (vd < 0.71) ? 5.01863891e-05 : \
+ (vd < 0.72) ? 4.34823346e-05 : \
+ (vd < 0.73) ? 3.78925857e-05 : \
+ (vd < 0.74) ? 4.90600969e-05 : \
+ (vd < 0.75) ? 5.04494642e-05 : \
+ (vd < 0.76) ? 4.77959911e-05 : \
+ (vd < 0.77) ? 5.18664523e-05 : \
+ (vd < 0.78) ? 4.78568224e-05 : \
+ (vd < 0.79) ? 4.37162825e-05 : \
+ (vd < 0.80) ? 4.37290344e-05 : \
+ 4.51348664e-05

* Table for Vg=0.7
.func vg_70(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 2.24015093e-06 : \
+ (vd < 0.03) ? 4.61373100e-06 : \
+ (vd < 0.04) ? 6.79435587e-06 : \
+ (vd < 0.05) ? 8.86846450e-06 : \
+ (vd < 0.06) ? 1.08165732e-05 : \
+ (vd < 0.07) ? 1.27282753e-05 : \
+ (vd < 0.08) ? 1.54860299e-05 : \
+ (vd < 0.09) ? 1.69770070e-05 : \
+ (vd < 0.10) ? 1.93940921e-05 : \
+ (vd < 0.11) ? 2.13115112e-05 : \
+ (vd < 0.12) ? 2.18716032e-05 : \
+ (vd < 0.13) ? 2.49877106e-05 : \
+ (vd < 0.14) ? 2.67442361e-05 : \
+ (vd < 0.15) ? 2.75046722e-05 : \
+ (vd < 0.16) ? 2.90543328e-05 : \
+ (vd < 0.17) ? 3.16768256e-05 : \
+ (vd < 0.18) ? 3.26238594e-05 : \
+ (vd < 0.19) ? 3.43705885e-05 : \
+ (vd < 0.20) ? 3.50367783e-05 : \
+ (vd < 0.21) ? 3.70874361e-05 : \
+ (vd < 0.22) ? 3.70778573e-05 : \
+ (vd < 0.23) ? 3.66302597e-05 : \
+ (vd < 0.24) ? 4.02611405e-05 : \
+ (vd < 0.25) ? 3.97190975e-05 : \
+ (vd < 0.26) ? 3.93823102e-05 : \
+ (vd < 0.27) ? 4.38394665e-05 : \
+ (vd < 0.28) ? 4.58400627e-05 : \
+ (vd < 0.29) ? 4.44176892e-05 : \
+ (vd < 0.30) ? 4.64690980e-05 : \
+ (vd < 0.31) ? 4.65894991e-05 : \
+ (vd < 0.32) ? 4.43002080e-05 : \
+ (vd < 0.33) ? 4.40137228e-05 : \
+ (vd < 0.34) ? 4.92911672e-05 : \
+ (vd < 0.35) ? 4.98882800e-05 : \
+ (vd < 0.36) ? 4.53856737e-05 : \
+ (vd < 0.37) ? 5.09685825e-05 : \
+ (vd < 0.38) ? 4.70984619e-05 : \
+ (vd < 0.39) ? 4.84028188e-05 : \
+ (vd < 0.40) ? 4.87598035e-05 : \
+ (vd < 0.41) ? 5.18700865e-05 : \
+ (vd < 0.42) ? 5.31238098e-05 : \
+ (vd < 0.43) ? 4.76824552e-05 : \
+ (vd < 0.44) ? 5.55873592e-05 : \
+ (vd < 0.45) ? 5.32104561e-05 : \
+ (vd < 0.46) ? 5.25387251e-05 : \
+ (vd < 0.47) ? 5.07852000e-05 : \
+ (vd < 0.48) ? 5.30766520e-05 : \
+ (vd < 0.49) ? 5.53057459e-05 : \
+ (vd < 0.50) ? 5.15006934e-05 : \
+ (vd < 0.51) ? 5.38271088e-05 : \
+ (vd < 0.52) ? 5.50890543e-05 : \
+ (vd < 0.53) ? 5.73237397e-05 : \
+ (vd < 0.54) ? 5.75769445e-05 : \
+ (vd < 0.55) ? 5.88023812e-05 : \
+ (vd < 0.56) ? 5.90547948e-05 : \
+ (vd < 0.57) ? 5.62636903e-05 : \
+ (vd < 0.58) ? 5.20755368e-05 : \
+ (vd < 0.59) ? 5.97903402e-05 : \
+ (vd < 0.60) ? 6.00280075e-05 : \
+ (vd < 0.61) ? 5.71338154e-05 : \
+ (vd < 0.62) ? 5.51176789e-05 : \
+ (vd < 0.63) ? 5.17654997e-05 : \
+ (vd < 0.64) ? 5.77325917e-05 : \
+ (vd < 0.65) ? 5.90184564e-05 : \
+ (vd < 0.66) ? 5.22010254e-05 : \
+ (vd < 0.67) ? 5.71292359e-05 : \
+ (vd < 0.68) ? 6.17331752e-05 : \
+ (vd < 0.69) ? 5.25681753e-05 : \
+ (vd < 0.70) ? 5.39302313e-05 : \
+ (vd < 0.71) ? 5.52764119e-05 : \
+ (vd < 0.72) ? 5.28610287e-05 : \
+ (vd < 0.73) ? 5.67067706e-05 : \
+ (vd < 0.74) ? 5.80169049e-05 : \
+ (vd < 0.75) ? 6.16497811e-05 : \
+ (vd < 0.76) ? 5.81836084e-05 : \
+ (vd < 0.77) ? 6.18389016e-05 : \
+ (vd < 0.78) ? 6.30754079e-05 : \
+ (vd < 0.79) ? 5.83606017e-05 : \
+ (vd < 0.80) ? 5.71469854e-05 : \
+ 6.20891573e-05

* Table for Vg=0.8
.func vg_80(vd) = \
+ (vd < 0.01) ? 0 : \
+ (vd < 0.02) ? 2.34385938e-06 : \
+ (vd < 0.03) ? 4.69392806e-06 : \
+ (vd < 0.04) ? 6.91687528e-06 : \
+ (vd < 0.05) ? 9.17744706e-06 : \
+ (vd < 0.06) ? 1.14855255e-05 : \
+ (vd < 0.07) ? 1.36215767e-05 : \
+ (vd < 0.08) ? 1.58511837e-05 : \
+ (vd < 0.09) ? 1.78961013e-05 : \
+ (vd < 0.10) ? 2.00136208e-05 : \
+ (vd < 0.11) ? 2.20274262e-05 : \
+ (vd < 0.12) ? 2.39026106e-05 : \
+ (vd < 0.13) ? 2.53009022e-05 : \
+ (vd < 0.14) ? 2.72533890e-05 : \
+ (vd < 0.15) ? 2.93306369e-05 : \
+ (vd < 0.16) ? 3.07160386e-05 : \
+ (vd < 0.17) ? 3.30983987e-05 : \
+ (vd < 0.18) ? 3.41821098e-05 : \
+ (vd < 0.19) ? 3.57414619e-05 : \
+ (vd < 0.20) ? 3.67020530e-05 : \
+ (vd < 0.21) ? 3.86934378e-05 : \
+ (vd < 0.22) ? 4.06502008e-05 : \
+ (vd < 0.23) ? 4.10903551e-05 : \
+ (vd < 0.24) ? 4.33557184e-05 : \
+ (vd < 0.25) ? 4.31470445e-05 : \
+ (vd < 0.26) ? 4.42662677e-05 : \
+ (vd < 0.27) ? 4.73718462e-05 : \
+ (vd < 0.28) ? 4.63398219e-05 : \
+ (vd < 0.29) ? 4.95829462e-05 : \
+ (vd < 0.30) ? 4.82004137e-05 : \
+ (vd < 0.31) ? 5.15868465e-05 : \
+ (vd < 0.32) ? 5.15218780e-05 : \
+ (vd < 0.33) ? 5.17979125e-05 : \
+ (vd < 0.34) ? 5.31362920e-05 : \
+ (vd < 0.35) ? 5.19958112e-05 : \
+ (vd < 0.36) ? 5.45706411e-05 : \
+ (vd < 0.37) ? 5.45783067e-05 : \
+ (vd < 0.38) ? 5.37620285e-05 : \
+ (vd < 0.39) ? 5.70825726e-05 : \
+ (vd < 0.40) ? 5.83060001e-05 : \
+ (vd < 0.41) ? 5.59950422e-05 : \
+ (vd < 0.42) ? 5.64409510e-05 : \
+ (vd < 0.43) ? 5.76458912e-05 : \
+ (vd < 0.44) ? 5.95882669e-05 : \
+ (vd < 0.45) ? 6.00080629e-05 : \
+ (vd < 0.46) ? 6.11656222e-05 : \
+ (vd < 0.47) ? 5.91735265e-05 : \
+ (vd < 0.48) ? 5.77877197e-05 : \
+ (vd < 0.49) ? 5.89757203e-05 : \
+ (vd < 0.50) ? 6.01502683e-05 : \
+ (vd < 0.51) ? 6.29624992e-05 : \
+ (vd < 0.52) ? 6.24595121e-05 : \
+ (vd < 0.53) ? 6.10372733e-05 : \
+ (vd < 0.54) ? 6.04170473e-05 : \
+ (vd < 0.55) ? 6.06871936e-05 : \
+ (vd < 0.56) ? 6.44875228e-05 : \
+ (vd < 0.57) ? 6.30378269e-05 : \
+ (vd < 0.58) ? 6.50578045e-05 : \
+ (vd < 0.59) ? 6.26637421e-05 : \
+ (vd < 0.60) ? 6.10156554e-05 : \
+ (vd < 0.61) ? 6.22275416e-05 : \
+ (vd < 0.62) ? 6.34257212e-05 : \
+ (vd < 0.63) ? 6.55263339e-05 : \
+ (vd < 0.64) ? 6.29424023e-05 : \
+ (vd < 0.65) ? 6.41468866e-05 : \
+ (vd < 0.66) ? 6.53365925e-05 : \
+ (vd < 0.67) ? 6.25866573e-05 : \
+ (vd < 0.68) ? 6.76714951e-05 : \
+ (vd < 0.69) ? 6.69647765e-05 : \
+ (vd < 0.70) ? 6.41958166e-05 : \
+ (vd < 0.71) ? 6.83387436e-05 : \
+ (vd < 0.72) ? 6.55797702e-05 : \
+ (vd < 0.73) ? 6.57468208e-05 : \
+ (vd < 0.74) ? 6.89201732e-05 : \
+ (vd < 0.75) ? 6.90919743e-05 : \
+ (vd < 0.76) ? 6.82525879e-05 : \
+ (vd < 0.77) ? 6.94003509e-05 : \
+ (vd < 0.78) ? 6.42107351e-05 : \
+ (vd < 0.79) ? 6.54126522e-05 : \
+ (vd < 0.80) ? 6.54906710e-05 : \
+ 6.66690757e-05

